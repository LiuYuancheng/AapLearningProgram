Use openssl in native c: 

https://teskalabs.com/blog/openssl-binary-distribution-for-developers-static-library

Session ID must register in the key exchange server first.